<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DHCR ‚Ä¢ Student Dashboard</title>
    <link rel="stylesheet" href="student.css" />
    <style>
      /* Inline CSS for new features */
      .star-rating {
        direction: rtl;
        display: inline-block;
        font-size: 1.5rem;
      }
      .star-rating input {
        display: none;
      }
      .star-rating label {
        color: #ddd;
        cursor: pointer;
      }
      .star-rating input:checked ~ label {
        color: #f39c12;
      }
      .star-rating label:hover,
      .star-rating label:hover ~ label {
        color: #f39c12;
      }

      .status-escalated {
        background-color: #ffebee;
        color: #c62828;
        border: 1px solid #ffcdd2;
      }

      /* Profile Photo Styles */
      .avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 50%;
      }
      .btn-xs {
        padding: 4px 8px;
        font-size: 0.8rem;
        margin-top: 5px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="page">
      <header class="topbar">
        <h1 class="welcome">
          Welcome, <span id="studentName">[Student Name]</span>
        </h1>
        <div class="top-actions">
          <button class="icon-btn" id="notifBtn" title="Notifications">
            üîî
          </button>
          <button class="icon-btn" id="profileBtn" title="Profile">üë§</button>
          <button class="btn-outline" id="logoutBtn" title="Logout">
            Logout
          </button>
        </div>
      </header>

      <div class="content">
        <section class="kpis">
          <article class="kpi-card">
            <p class="kpi-label">Pending Complaints</p>
            <p class="kpi-value" id="kpiPending">0</p>
          </article>
          <article class="kpi-card">
            <p class="kpi-label">Resolved Complaints</p>
            <p class="kpi-value" id="kpiResolved">0</p>
          </article>
          <article class="kpi-card">
            <p class="kpi-label">Resale Items</p>
            <p class="kpi-value" id="kpiResale">0</p>
          </article>
        </section>

        <section class="grid">
          <div class="card">
            <div class="card-head">
              <h2>Latest Notices</h2>
              <span class="hint">Posted by <strong>Warden</strong></span>
            </div>
            <ul class="notice-list" id="noticeList"></ul>
            <div class="card-foot">
              <button class="link-btn" id="viewAllNotices">
                View all notices
              </button>
            </div>
          </div>

          <div class="card">
            <div class="card-head"><h2>Quick Links</h2></div>
            <div class="quick-links">
              <button class="ql-btn" data-open="raiseComplaint">
                üéì Lodge Complaint
              </button>
              <button class="ql-btn" data-open="myComplaints">
                üë• My Complaints
              </button>
              <button class="ql-btn" data-open="resaleMarket">
                ü™ô Resale Market
              </button>
              <button class="ql-btn" data-open="profile">‚úÖ Profile</button>
            </div>
          </div>

          <div class="card wide">
            <div class="card-head"><h2>Recent Activity</h2></div>
            <ul class="activity" id="activityList"></ul>
          </div>
        </section>
      </div>

      <footer class="footer">
        ¬© <span id="year"></span> DHCR ‚Ä¢ Contact Support ‚Ä¢ Help
      </footer>
    </div>

    <div id="complaintModal" class="modal" aria-hidden="true" role="dialog">
      <div class="modal-card">
        <button class="modal-close" id="lcClose" aria-label="Close">√ó</button>
        <h2 id="lcTitle">Lodge a Complaint</h2>
        <p class="breadcrumb">Dashboard ‚Ä¢ Lodge Complaint</p>

        <form id="lcForm" autocomplete="off">
          <label class="field">
            <span>Complaint Type</span>
            <select id="lcType" required>
              <option value="" selected disabled>Select type</option>
              <option>Electrical</option>
              <option>Plumbing</option>
              <option>Housekeeping</option>
              <option>Internet / Wi-Fi</option>
              <option>Other</option>
            </select>
          </label>

          <label class="field">
            <span>Complaint Description</span>
            <textarea
              id="lcDesc"
              rows="4"
              placeholder="Describe the issue‚Ä¶"
              required
            ></textarea>
          </label>

          <label class="field">
            <span>Preferred Time Slot</span>
            <select id="lcSlot" required>
              <option value="" selected disabled>Select a slot</option>
              <option>08:00 AM ‚Äì 10:00 AM</option>
              <option>10:00 AM ‚Äì 12:00 PM</option>
              <option>12:00 PM ‚Äì 02:00 PM</option>
              <option>02:00 PM ‚Äì 04:00 PM</option>
              <option>04:00 PM ‚Äì 06:00 PM</option>
              <option>06:00 PM ‚Äì 08:00 PM</option>
            </select>
          </label>

          <div class="actions">
            <button type="submit" class="btn-primary">Submit Complaint</button>
            <button type="reset" class="btn-ghost">Reset Form</button>
          </div>
        </form>
      </div>
    </div>

    <div id="complaintsModal" class="modal" aria-hidden="true" role="dialog">
      <div class="modal-card wide">
        <button class="modal-close" id="mcClose" aria-label="Close">√ó</button>
        <h2>My Complaints</h2>
        <p class="breadcrumb">Dashboard ‚Ä¢ My Complaints</p>

        <div class="filter-bar">
          <select id="mcFilter">
            <option value="all">All</option>
            <option value="pending">Pending</option>
            <option value="progress">In Progress</option>
            <option value="resolved">Resolved</option>
          </select>
        </div>

        <div class="table-wrapper">
          <table class="complaints-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Type</th>
                <th>Description</th>
                <th>Date</th>
                <th>Slot</th>
                <th>Status</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody id="complaintsBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div id="feedbackModal" class="modal" aria-hidden="true">
      <div class="modal-card">
        <button class="modal-close" id="fbClose">√ó</button>
        <h2>üìù Submit Feedback</h2>
        <p class="breadcrumb">Confirm Resolution</p>

        <form id="fbForm">
          <input type="hidden" id="fbComplaintId" />

          <div class="field">
            <label>Rate Service <span style="color: red">*</span></label>
            <div class="star-rating">
              <input type="radio" name="rating" value="5" id="r5" /><label
                for="r5"
                >‚òÖ</label
              >
              <input type="radio" name="rating" value="4" id="r4" /><label
                for="r4"
                >‚òÖ</label
              >
              <input type="radio" name="rating" value="3" id="r3" /><label
                for="r3"
                >‚òÖ</label
              >
              <input type="radio" name="rating" value="2" id="r2" /><label
                for="r2"
                >‚òÖ</label
              >
              <input
                type="radio"
                name="rating"
                value="1"
                id="r1"
                required
              /><label for="r1">‚òÖ</label>
            </div>
          </div>

          <label class="field">
            <span>Comments <span style="color: red">*</span></span>
            <textarea
              id="fbComment"
              rows="3"
              placeholder="How was the service?"
              required
            ></textarea>
          </label>

          <label class="field">
            <span
              >Upload Proof of Resolution
              <span style="color: red">*</span></span
            >
            <input type="file" id="fbProof" accept="image/*" required />
            <small style="color: #666; font-size: 0.85em"
              >Image required to close complaint.</small
            >
          </label>

          <div class="actions">
            <button type="submit" class="btn-primary">Submit & Close</button>
            <button type="button" class="btn-ghost" id="fbCancel">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>

    <div id="escalateModal" class="modal" aria-hidden="true">
      <div class="modal-card">
        <button class="modal-close" id="escClose">√ó</button>
        <h2 style="color: #dc3545">‚ö†Ô∏è Report Issue Not Solved</h2>
        <p class="breadcrumb">Dashboard ‚Ä¢ Escalate</p>

        <form id="escForm">
          <input type="hidden" id="escComplaintId" />

          <label class="field">
            <span
              >Why is this not solved? <span style="color: red">*</span></span
            >
            <textarea
              id="escReason"
              rows="3"
              placeholder="e.g., The tap is still leaking..."
              required
            ></textarea>
          </label>

          <label class="field">
            <span>Upload Photo Proof <span style="color: red">*</span></span>
            <input type="file" id="escProof" accept="image/*" required />
            <small style="color: #666; font-size: 0.85em"
              >Show the warden that the issue persists.</small
            >
          </label>

          <div class="actions">
            <button
              type="submit"
              class="btn-primary"
              style="background-color: #dc3545"
            >
              Escalate to Warden
            </button>
            <button type="button" class="btn-ghost" id="escCancel">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>

    <div id="resaleModal" class="modal" aria-hidden="true" role="dialog">
      <div class="modal-card widest">
        <button class="modal-close" id="rsClose" aria-label="Close">√ó</button>
        <h2 id="rsTitle">Resale Items</h2>

        <div class="rs-toolbar">
          <input type="text" id="rsSearch" placeholder="üîç Search..." />
          <select id="rsCategory">
            <option value="all">All Categories</option>
            <option value="electronics">Electronics</option>
            <option value="books">Books</option>
            <option value="furniture">Furniture</option>
            <option value="misc">Misc</option>
          </select>
          <button class="btn-primary" id="rsPostBtn">+ Post Item</button>
        </div>

        <div class="rs-grid" id="rsGrid"></div>
      </div>
    </div>

    <div id="postItemModal" class="modal" aria-hidden="true" role="dialog">
      <div class="modal-card" style="max-width: 640px">
        <button class="modal-close" id="piClose" aria-label="Close">√ó</button>
        <h2>Post a New Item</h2>
        <form id="piForm" class="rs-post-form" autocomplete="off">
          <label class="field">
            <span>Item Name</span>
            <input
              id="piName"
              type="text"
              required
              placeholder="e.g., Study Table"
            />
          </label>
          <label class="field">
            <span>Price (‚Çπ)</span>
            <input
              id="piPrice"
              type="number"
              min="0"
              required
              placeholder="e.g., 1200"
            />
          </label>
          <label class="field">
            <span>Category</span>
            <select id="piCategory" required>
              <option value="electronics">Electronics</option>
              <option value="books">Books</option>
              <option value="furniture">Furniture</option>
              <option value="misc" selected>Misc</option>
            </select>
          </label>
          <label class="field">
            <span>Description</span>
            <textarea
              id="piDesc"
              rows="3"
              placeholder="Short description"
            ></textarea>
          </label>

          <label class="field">
            <span>Upload Image <span style="color: red">*</span></span>
            <input type="file" id="piImage" accept="image/*" required />
          </label>

          <div class="actions">
            <button type="submit" class="btn-primary">Post Item</button>
          </div>
        </form>
      </div>
    </div>

    <div id="profileModal" class="modal" aria-hidden="true" role="dialog">
      <div class="modal-card widest profile-card">
        <button class="modal-close" id="pfClose" aria-label="Close">√ó</button>
        <h2>Profile</h2>

        <div class="profile-wrap">
          <aside class="profile-left">
            <div class="avatar">
              <img id="pfPhoto" src="" alt="Profile" style="display: none" />
              <span class="avatar-fallback" id="pfPhotoFallback">üë§</span>
              <input
                type="file"
                id="pfPhotoInput"
                accept="image/*"
                style="display: none"
              />
              <button type="button" id="pfChangePhoto" class="btn-xs">
                Change Photo
              </button>
            </div>
            <h3 id="pfNameLeft">Student Name</h3>
            <p class="role-chip">STUDENT</p>
          </aside>

          <section class="profile-right">
            <nav class="tabs-row">
              <button class="tab-btn active" data-tab="account">Account</button>
              <button class="tab-btn" data-tab="emergency">Emergency</button>
            </nav>

            <form id="pfForm" class="tab-panels">
              <div class="tab-panel active" id="tab-account">
                <label class="field">
                  <span>Full Name</span>
                  <input id="pfFullName" type="text" required />
                </label>
                <label class="field">
                  <span>Email</span>
                  <input id="pfEmail" type="email" class="readonly" readonly />
                </label>
                <label class="field">
                  <span>Phone Number</span>
                  <input id="pfPhone" type="tel" />
                </label>
                <label class="field">
                  <span>Address</span>
                  <textarea id="pfAddress" rows="2"></textarea>
                </label>
              </div>

              <div class="tab-panel" id="tab-emergency">
                <label class="field">
                  <span>Emergency Phone</span>
                  <input id="pfEmergPhone" type="tel" />
                </label>
                <label class="field">
                  <span>Student ID</span>
                  <input id="pfRoll" type="text" class="readonly" readonly />
                </label>
                <label class="field">
                  <span>Course</span>
                  <input id="pfCourseYear" type="text" />
                </label>
              </div>

              <div class="save-row">
                <button type="submit" class="btn-primary">Save Changes</button>
              </div>
            </form>
          </section>
        </div>
      </div>
    </div>

    <div id="noticesModal" class="modal" aria-hidden="true">
      <div class="modal-card widest">
        <button class="modal-close" id="ntClose">√ó</button>
        <h2>All Notices</h2>
        <div class="notice-list-full" id="allNoticesBody"></div>
      </div>
    </div>

    <script src="student.js"></script>
  </body>
</html>
